
Method: lstm, # genres: 2
Epoch 1/1000
156/156 - 10s - 65ms/step - accuracy: 0.6528 - loss: 0.5938 - val_accuracy: 0.7541 - val_loss: 0.5360
Epoch 2/1000
156/156 - 8s - 49ms/step - accuracy: 0.8151 - loss: 0.4259 - val_accuracy: 0.7863 - val_loss: 0.4669
Epoch 3/1000
156/156 - 8s - 50ms/step - accuracy: 0.8783 - loss: 0.3020 - val_accuracy: 0.7705 - val_loss: 0.5339
Epoch 4/1000
156/156 - 8s - 50ms/step - accuracy: 0.9306 - loss: 0.1859 - val_accuracy: 0.6999 - val_loss: 0.7549
Epoch 5/1000
156/156 - 8s - 49ms/step - accuracy: 0.9539 - loss: 0.1236 - val_accuracy: 0.7433 - val_loss: 0.8418
Epoch 6/1000
156/156 - 15s - 97ms/step - accuracy: 0.9711 - loss: 0.0814 - val_accuracy: 0.7443 - val_loss: 1.1067
Epoch 7/1000
156/156 - 25s - 159ms/step - accuracy: 0.9771 - loss: 0.0660 - val_accuracy: 0.7377 - val_loss: 1.0187
Epoch 8/1000
156/156 - 19s - 124ms/step - accuracy: 0.9813 - loss: 0.0536 - val_accuracy: 0.7349 - val_loss: 1.2444
Epoch 9/1000
156/156 - 18s - 118ms/step - accuracy: 0.9828 - loss: 0.0524 - val_accuracy: 0.6961 - val_loss: 1.0611
Epoch 10/1000
156/156 - 18s - 118ms/step - accuracy: 0.9854 - loss: 0.0433 - val_accuracy: 0.7396 - val_loss: 1.2471
Epoch 11/1000
156/156 - 19s - 121ms/step - accuracy: 0.9924 - loss: 0.0277 - val_accuracy: 0.7447 - val_loss: 1.3646
Epoch 12/1000
156/156 - 19s - 123ms/step - accuracy: 0.9894 - loss: 0.0312 - val_accuracy: 0.7172 - val_loss: 1.3133
Epoch 12: early stopping
Restoring model weights from the end of the best epoch: 2.
Calculating predictions on the test set ..
[Macro]    P: 76.59   R: 76.54   F1: 76.56
[Weighted] P: 78.62   R: 78.63   F1: 78.63

Method: lstm, # genres: 3
Epoch 1/1000
200/200 - 28s - 139ms/step - accuracy: 0.5798 - loss: 0.8175 - val_accuracy: 0.5140 - val_loss: 0.7388
Epoch 2/1000
200/200 - 40s - 200ms/step - accuracy: 0.7192 - loss: 0.5715 - val_accuracy: 0.7140 - val_loss: 0.6246
Epoch 3/1000
200/200 - 42s - 209ms/step - accuracy: 0.8367 - loss: 0.3844 - val_accuracy: 0.7070 - val_loss: 0.7530
Epoch 4/1000
200/200 - 24s - 120ms/step - accuracy: 0.8942 - loss: 0.2680 - val_accuracy: 0.7329 - val_loss: 0.6873
Epoch 5/1000
200/200 - 41s - 205ms/step - accuracy: 0.9281 - loss: 0.1910 - val_accuracy: 0.7384 - val_loss: 0.7959
Epoch 6/1000
200/200 - 46s - 231ms/step - accuracy: 0.9468 - loss: 0.1505 - val_accuracy: 0.7464 - val_loss: 0.8700
Epoch 7/1000
200/200 - 37s - 183ms/step - accuracy: 0.9544 - loss: 0.1290 - val_accuracy: 0.7129 - val_loss: 0.9125
Epoch 8/1000
200/200 - 27s - 133ms/step - accuracy: 0.9637 - loss: 0.1071 - val_accuracy: 0.7070 - val_loss: 1.0046
Epoch 9/1000
200/200 - 26s - 132ms/step - accuracy: 0.9638 - loss: 0.1078 - val_accuracy: 0.7322 - val_loss: 1.1562
Epoch 10/1000
200/200 - 44s - 221ms/step - accuracy: 0.9746 - loss: 0.0764 - val_accuracy: 0.7519 - val_loss: 1.2230
Epoch 11/1000
200/200 - 37s - 186ms/step - accuracy: 0.9801 - loss: 0.0570 - val_accuracy: 0.7475 - val_loss: 1.1892
Epoch 12/1000
200/200 - 41s - 207ms/step - accuracy: 0.9845 - loss: 0.0441 - val_accuracy: 0.7326 - val_loss: 1.2553
Epoch 13/1000
200/200 - 42s - 208ms/step - accuracy: 0.9941 - loss: 0.0221 - val_accuracy: 0.7461 - val_loss: 1.5587
Epoch 14/1000
200/200 - 44s - 220ms/step - accuracy: 0.9945 - loss: 0.0171 - val_accuracy: 0.7472 - val_loss: 1.6686
Epoch 15/1000
200/200 - 39s - 195ms/step - accuracy: 0.9961 - loss: 0.0138 - val_accuracy: 0.7308 - val_loss: 1.6049
Epoch 16/1000
200/200 - 41s - 204ms/step - accuracy: 0.9942 - loss: 0.0170 - val_accuracy: 0.7384 - val_loss: 1.6575
Epoch 17/1000
200/200 - 36s - 182ms/step - accuracy: 0.9945 - loss: 0.0158 - val_accuracy: 0.7501 - val_loss: 1.7493
Epoch 18/1000
200/200 - 42s - 208ms/step - accuracy: 0.9945 - loss: 0.0193 - val_accuracy: 0.7395 - val_loss: 1.6469
Epoch 19/1000
200/200 - 25s - 123ms/step - accuracy: 0.9869 - loss: 0.0394 - val_accuracy: 0.7286 - val_loss: 1.4595
Epoch 20/1000
200/200 - 40s - 200ms/step - accuracy: 0.9966 - loss: 0.0108 - val_accuracy: 0.7432 - val_loss: 1.7144
Epoch 20: early stopping
Restoring model weights from the end of the best epoch: 10.
Calculating predictions on the test set ..
[Macro]    P: 75.13   R: 75.27   F1: 75.2
[Weighted] P: 75.22   R: 75.19   F1: 75.2

Method: lstm, # genres: 4
Epoch 1/1000
304/304 - 43s - 140ms/step - accuracy: 0.4236 - loss: 1.1212 - val_accuracy: 0.4580 - val_loss: 1.0904
Epoch 2/1000
304/304 - 24s - 78ms/step - accuracy: 0.4756 - loss: 1.0583 - val_accuracy: 0.4748 - val_loss: 1.0660
Epoch 3/1000
304/304 - 15s - 50ms/step - accuracy: 0.5972 - loss: 0.8422 - val_accuracy: 0.5897 - val_loss: 0.9519
Epoch 4/1000
304/304 - 15s - 50ms/step - accuracy: 0.7315 - loss: 0.6505 - val_accuracy: 0.6173 - val_loss: 0.9337
Epoch 5/1000
304/304 - 15s - 50ms/step - accuracy: 0.8018 - loss: 0.5015 - val_accuracy: 0.6336 - val_loss: 0.9557
Epoch 6/1000
304/304 - 16s - 51ms/step - accuracy: 0.8492 - loss: 0.3994 - val_accuracy: 0.6374 - val_loss: 1.0139
Epoch 7/1000
304/304 - 15s - 51ms/step - accuracy: 0.8754 - loss: 0.3293 - val_accuracy: 0.6307 - val_loss: 1.0412
Epoch 8/1000
304/304 - 15s - 51ms/step - accuracy: 0.9036 - loss: 0.2738 - val_accuracy: 0.6353 - val_loss: 1.1311
Epoch 9/1000
304/304 - 15s - 50ms/step - accuracy: 0.9151 - loss: 0.2289 - val_accuracy: 0.6259 - val_loss: 1.2485
Epoch 10/1000
304/304 - 16s - 52ms/step - accuracy: 0.9356 - loss: 0.1806 - val_accuracy: 0.6319 - val_loss: 1.3270
Epoch 11/1000
304/304 - 16s - 52ms/step - accuracy: 0.9459 - loss: 0.1469 - val_accuracy: 0.6141 - val_loss: 1.5113
Epoch 12/1000
304/304 - 15s - 51ms/step - accuracy: 0.9546 - loss: 0.1215 - val_accuracy: 0.6353 - val_loss: 1.5442
Epoch 13/1000
304/304 - 16s - 51ms/step - accuracy: 0.9656 - loss: 0.1006 - val_accuracy: 0.6223 - val_loss: 1.7554
Epoch 14/1000
304/304 - 16s - 53ms/step - accuracy: 0.9628 - loss: 0.1099 - val_accuracy: 0.6324 - val_loss: 1.6496
Epoch 15/1000
304/304 - 16s - 52ms/step - accuracy: 0.9682 - loss: 0.0838 - val_accuracy: 0.6161 - val_loss: 1.7911
Epoch 16/1000
304/304 - 16s - 52ms/step - accuracy: 0.9760 - loss: 0.0657 - val_accuracy: 0.6168 - val_loss: 2.0234
Epoch 16: early stopping
Restoring model weights from the end of the best epoch: 6.
Calculating predictions on the test set ..
[Macro]    P: 65.31   R: 67.09   F1: 65.86
[Weighted] P: 64.64   R: 63.74   F1: 63.86

Method: lstm, # genres: 5
Epoch 1/1000
331/331 - 20s - 59ms/step - accuracy: 0.3765 - loss: 1.3417 - val_accuracy: 0.4631 - val_loss: 1.2776
Epoch 2/1000
331/331 - 17s - 52ms/step - accuracy: 0.5443 - loss: 0.9580 - val_accuracy: 0.5362 - val_loss: 1.0565
Epoch 3/1000
331/331 - 17s - 51ms/step - accuracy: 0.6653 - loss: 0.7146 - val_accuracy: 0.5959 - val_loss: 1.0558
Epoch 4/1000
331/331 - 17s - 50ms/step - accuracy: 0.7719 - loss: 0.5299 - val_accuracy: 0.6158 - val_loss: 1.0946
Epoch 5/1000
331/331 - 17s - 50ms/step - accuracy: 0.8206 - loss: 0.4371 - val_accuracy: 0.6048 - val_loss: 1.1107
Epoch 6/1000
331/331 - 17s - 51ms/step - accuracy: 0.8575 - loss: 0.3484 - val_accuracy: 0.6215 - val_loss: 1.1826
Epoch 7/1000
331/331 - 17s - 51ms/step - accuracy: 0.8886 - loss: 0.2860 - val_accuracy: 0.6131 - val_loss: 1.3003
Epoch 8/1000
331/331 - 17s - 51ms/step - accuracy: 0.8906 - loss: 0.2838 - val_accuracy: 0.6070 - val_loss: 1.4228
Epoch 9/1000
331/331 - 17s - 51ms/step - accuracy: 0.9171 - loss: 0.2032 - val_accuracy: 0.6059 - val_loss: 1.4777
Epoch 10/1000
331/331 - 18s - 53ms/step - accuracy: 0.9344 - loss: 0.1620 - val_accuracy: 0.6021 - val_loss: 1.6602
Epoch 11/1000
331/331 - 17s - 53ms/step - accuracy: 0.9468 - loss: 0.1354 - val_accuracy: 0.5984 - val_loss: 1.7377
Epoch 12/1000
331/331 - 17s - 52ms/step - accuracy: 0.9579 - loss: 0.1043 - val_accuracy: 0.5973 - val_loss: 1.9210
Epoch 13/1000
331/331 - 17s - 52ms/step - accuracy: 0.9566 - loss: 0.1219 - val_accuracy: 0.6059 - val_loss: 1.9026
Epoch 14/1000
331/331 - 17s - 52ms/step - accuracy: 0.9583 - loss: 0.1095 - val_accuracy: 0.6026 - val_loss: 2.0267
Epoch 15/1000
331/331 - 17s - 52ms/step - accuracy: 0.9680 - loss: 0.0848 - val_accuracy: 0.6136 - val_loss: 2.1720
Epoch 16/1000
331/331 - 17s - 53ms/step - accuracy: 0.9677 - loss: 0.0865 - val_accuracy: 0.5887 - val_loss: 2.2170
Epoch 16: early stopping
Restoring model weights from the end of the best epoch: 6.
Calculating predictions on the test set ..
[Macro]    P: 63.23   R: 63.01   F1: 62.97
[Weighted] P: 62.67   R: 62.15   F1: 62.27

Method: lstm, # genres: 6
Epoch 1/1000
427/427 - 25s - 58ms/step - accuracy: 0.3419 - loss: 1.5040 - val_accuracy: 0.5127 - val_loss: 1.2020
Epoch 2/1000
427/427 - 22s - 52ms/step - accuracy: 0.5670 - loss: 1.0455 - val_accuracy: 0.5658 - val_loss: 1.1020
Epoch 3/1000
427/427 - 22s - 52ms/step - accuracy: 0.6708 - loss: 0.7965 - val_accuracy: 0.6056 - val_loss: 1.0204
Epoch 4/1000
427/427 - 22s - 53ms/step - accuracy: 0.7623 - loss: 0.6045 - val_accuracy: 0.6143 - val_loss: 1.1203
Epoch 5/1000
427/427 - 22s - 52ms/step - accuracy: 0.8193 - loss: 0.4644 - val_accuracy: 0.6359 - val_loss: 1.1074
Epoch 6/1000
427/427 - 22s - 53ms/step - accuracy: 0.8574 - loss: 0.3690 - val_accuracy: 0.6225 - val_loss: 1.2177
Epoch 7/1000
427/427 - 23s - 54ms/step - accuracy: 0.8772 - loss: 0.3222 - val_accuracy: 0.6248 - val_loss: 1.3934
Epoch 8/1000
427/427 - 22s - 52ms/step - accuracy: 0.8936 - loss: 0.2705 - val_accuracy: 0.6213 - val_loss: 1.4885
Epoch 9/1000
427/427 - 22s - 53ms/step - accuracy: 0.9117 - loss: 0.2247 - val_accuracy: 0.6048 - val_loss: 1.6327
Epoch 10/1000
427/427 - 22s - 52ms/step - accuracy: 0.9126 - loss: 0.2244 - val_accuracy: 0.6164 - val_loss: 1.5576
Epoch 11/1000
427/427 - 22s - 52ms/step - accuracy: 0.9369 - loss: 0.1575 - val_accuracy: 0.6314 - val_loss: 1.7313
Epoch 12/1000
427/427 - 33s - 77ms/step - accuracy: 0.9382 - loss: 0.1564 - val_accuracy: 0.6311 - val_loss: 1.7682
Epoch 13/1000
427/427 - 36s - 84ms/step - accuracy: 0.9452 - loss: 0.1395 - val_accuracy: 0.6325 - val_loss: 1.8110
Epoch 14/1000
427/427 - 58s - 136ms/step - accuracy: 0.9486 - loss: 0.1308 - val_accuracy: 0.6113 - val_loss: 1.8862
Epoch 15/1000
427/427 - 82s - 192ms/step - accuracy: 0.9648 - loss: 0.0929 - val_accuracy: 0.6183 - val_loss: 2.2235
Epoch 15: early stopping
Restoring model weights from the end of the best epoch: 5.
Calculating predictions on the test set ..
[Macro]    P: 63.03   R: 63.95   F1: 63.41
[Weighted] P: 64.04   R: 63.59   F1: 63.74

Method: lstm, # genres: 7
Epoch 1/1000
450/450 - 65s - 144ms/step - accuracy: 0.3244 - loss: 1.6114 - val_accuracy: 0.4684 - val_loss: 1.4256
Epoch 2/1000
450/450 - 71s - 158ms/step - accuracy: 0.5216 - loss: 1.1917 - val_accuracy: 0.4840 - val_loss: 1.3751
Epoch 3/1000
450/450 - 28s - 62ms/step - accuracy: 0.5791 - loss: 1.0198 - val_accuracy: 0.5525 - val_loss: 1.2246
Epoch 4/1000
450/450 - 24s - 53ms/step - accuracy: 0.6704 - loss: 0.7842 - val_accuracy: 0.5760 - val_loss: 1.1990
Epoch 5/1000
450/450 - 24s - 52ms/step - accuracy: 0.7414 - loss: 0.6306 - val_accuracy: 0.5596 - val_loss: 1.3091
Epoch 6/1000
450/450 - 25s - 56ms/step - accuracy: 0.7907 - loss: 0.5278 - val_accuracy: 0.5637 - val_loss: 1.3390
Epoch 7/1000
450/450 - 56s - 124ms/step - accuracy: 0.8267 - loss: 0.4245 - val_accuracy: 0.5862 - val_loss: 1.3824
Epoch 8/1000
450/450 - 38s - 85ms/step - accuracy: 0.8581 - loss: 0.3521 - val_accuracy: 0.6063 - val_loss: 1.5000
Epoch 9/1000
450/450 - 23s - 51ms/step - accuracy: 0.8657 - loss: 0.3310 - val_accuracy: 0.5964 - val_loss: 1.5420
Epoch 10/1000
450/450 - 23s - 52ms/step - accuracy: 0.8889 - loss: 0.2700 - val_accuracy: 0.5930 - val_loss: 1.6686
Epoch 11/1000
450/450 - 23s - 52ms/step - accuracy: 0.9081 - loss: 0.2261 - val_accuracy: 0.5750 - val_loss: 1.7635
Epoch 12/1000
450/450 - 24s - 53ms/step - accuracy: 0.9265 - loss: 0.1925 - val_accuracy: 0.6017 - val_loss: 1.9246
Epoch 13/1000
450/450 - 24s - 52ms/step - accuracy: 0.9304 - loss: 0.1828 - val_accuracy: 0.5951 - val_loss: 1.9147
Epoch 14/1000
450/450 - 23s - 52ms/step - accuracy: 0.9342 - loss: 0.1767 - val_accuracy: 0.5864 - val_loss: 2.0150
Epoch 15/1000
450/450 - 23s - 52ms/step - accuracy: 0.9355 - loss: 0.1668 - val_accuracy: 0.5757 - val_loss: 1.9359
Epoch 16/1000
450/450 - 23s - 52ms/step - accuracy: 0.9478 - loss: 0.1308 - val_accuracy: 0.5870 - val_loss: 2.2240
Epoch 17/1000
450/450 - 23s - 52ms/step - accuracy: 0.9536 - loss: 0.1184 - val_accuracy: 0.5860 - val_loss: 2.2532
Epoch 18/1000
450/450 - 24s - 53ms/step - accuracy: 0.9589 - loss: 0.1041 - val_accuracy: 0.5958 - val_loss: 2.3651
Epoch 18: early stopping
Restoring model weights from the end of the best epoch: 8.
Calculating predictions on the test set ..
[Macro]    P: 58.36   R: 60.55   F1: 59.0
[Weighted] P: 60.99   R: 60.63   F1: 60.61

Method: lstm, # genres: 8
Epoch 1/1000
543/543 - 28s - 52ms/step - accuracy: 0.2771 - loss: 1.7926 - val_accuracy: 0.4252 - val_loss: 1.5563
Epoch 2/1000
543/543 - 27s - 50ms/step - accuracy: 0.4666 - loss: 1.3433 - val_accuracy: 0.4785 - val_loss: 1.4311
Epoch 3/1000
543/543 - 27s - 50ms/step - accuracy: 0.5516 - loss: 1.1019 - val_accuracy: 0.4914 - val_loss: 1.3834
Epoch 4/1000
543/543 - 28s - 52ms/step - accuracy: 0.6222 - loss: 0.9230 - val_accuracy: 0.5167 - val_loss: 1.3772
Epoch 5/1000
543/543 - 28s - 52ms/step - accuracy: 0.6799 - loss: 0.7683 - val_accuracy: 0.5164 - val_loss: 1.4174
Epoch 6/1000
543/543 - 28s - 51ms/step - accuracy: 0.7296 - loss: 0.6448 - val_accuracy: 0.5406 - val_loss: 1.4861
Epoch 7/1000
543/543 - 28s - 52ms/step - accuracy: 0.7715 - loss: 0.5562 - val_accuracy: 0.5445 - val_loss: 1.5370
Epoch 8/1000
543/543 - 28s - 52ms/step - accuracy: 0.7967 - loss: 0.4958 - val_accuracy: 0.5439 - val_loss: 1.6076
Epoch 9/1000
543/543 - 28s - 52ms/step - accuracy: 0.8318 - loss: 0.4076 - val_accuracy: 0.5402 - val_loss: 1.7526
Epoch 10/1000
543/543 - 28s - 51ms/step - accuracy: 0.8566 - loss: 0.3534 - val_accuracy: 0.5506 - val_loss: 1.7868
Epoch 11/1000
543/543 - 36s - 66ms/step - accuracy: 0.8778 - loss: 0.2981 - val_accuracy: 0.5293 - val_loss: 2.0476
Epoch 12/1000
543/543 - 87s - 160ms/step - accuracy: 0.8896 - loss: 0.2760 - val_accuracy: 0.5399 - val_loss: 2.0464
Epoch 13/1000
543/543 - 82s - 151ms/step - accuracy: 0.9041 - loss: 0.2395 - val_accuracy: 0.5306 - val_loss: 2.0984
Epoch 14/1000
543/543 - 27s - 50ms/step - accuracy: 0.9143 - loss: 0.2134 - val_accuracy: 0.5263 - val_loss: 2.2609
Epoch 15/1000
543/543 - 27s - 50ms/step - accuracy: 0.9220 - loss: 0.1912 - val_accuracy: 0.5508 - val_loss: 2.4657
Epoch 16/1000
543/543 - 28s - 51ms/step - accuracy: 0.9354 - loss: 0.1529 - val_accuracy: 0.5355 - val_loss: 2.6104
Epoch 17/1000
543/543 - 28s - 51ms/step - accuracy: 0.9344 - loss: 0.1652 - val_accuracy: 0.5228 - val_loss: 2.5261
Epoch 18/1000
543/543 - 28s - 51ms/step - accuracy: 0.9433 - loss: 0.1455 - val_accuracy: 0.5428 - val_loss: 2.7990
Epoch 19/1000
543/543 - 28s - 51ms/step - accuracy: 0.9557 - loss: 0.1122 - val_accuracy: 0.5377 - val_loss: 3.0840
Epoch 20/1000
543/543 - 28s - 52ms/step - accuracy: 0.9593 - loss: 0.1007 - val_accuracy: 0.5346 - val_loss: 2.9338
Epoch 21/1000
543/543 - 28s - 51ms/step - accuracy: 0.9563 - loss: 0.1113 - val_accuracy: 0.5411 - val_loss: 3.0589
Epoch 22/1000
543/543 - 28s - 52ms/step - accuracy: 0.9623 - loss: 0.0951 - val_accuracy: 0.5328 - val_loss: 3.0101
Epoch 23/1000
543/543 - 28s - 51ms/step - accuracy: 0.9609 - loss: 0.1024 - val_accuracy: 0.5482 - val_loss: 3.3041
Epoch 24/1000
543/543 - 28s - 52ms/step - accuracy: 0.9736 - loss: 0.0671 - val_accuracy: 0.5134 - val_loss: 3.3105
Epoch 25/1000
543/543 - 28s - 51ms/step - accuracy: 0.9654 - loss: 0.0906 - val_accuracy: 0.5377 - val_loss: 3.5397
Epoch 25: early stopping
Restoring model weights from the end of the best epoch: 15.
Calculating predictions on the test set ..
[Macro]    P: 54.88   R: 56.41   F1: 55.53
[Weighted] P: 54.87   R: 55.08   F1: 54.86

Method: lstm, # genres: 9
Epoch 1/1000
567/567 - 32s - 56ms/step - accuracy: 0.2833 - loss: 1.8219 - val_accuracy: 0.3690 - val_loss: 1.6250
Epoch 2/1000
567/567 - 30s - 53ms/step - accuracy: 0.4300 - loss: 1.4807 - val_accuracy: 0.4667 - val_loss: 1.4686
Epoch 3/1000
567/567 - 33s - 58ms/step - accuracy: 0.5178 - loss: 1.2099 - val_accuracy: 0.4959 - val_loss: 1.4167
Epoch 4/1000
567/567 - 74s - 131ms/step - accuracy: 0.5923 - loss: 1.0361 - val_accuracy: 0.4598 - val_loss: 1.4393
Epoch 5/1000
567/567 - 47s - 84ms/step - accuracy: 0.6388 - loss: 0.9026 - val_accuracy: 0.4834 - val_loss: 1.4911
Epoch 6/1000
567/567 - 54s - 96ms/step - accuracy: 0.6926 - loss: 0.7585 - val_accuracy: 0.4994 - val_loss: 1.5787
Epoch 7/1000
567/567 - 47s - 83ms/step - accuracy: 0.7419 - loss: 0.6394 - val_accuracy: 0.5040 - val_loss: 1.6424
Epoch 8/1000
567/567 - 45s - 80ms/step - accuracy: 0.7688 - loss: 0.5758 - val_accuracy: 0.5051 - val_loss: 1.6488
Epoch 9/1000
567/567 - 47s - 82ms/step - accuracy: 0.7992 - loss: 0.4934 - val_accuracy: 0.5099 - val_loss: 1.7683
Epoch 10/1000
567/567 - 46s - 81ms/step - accuracy: 0.8252 - loss: 0.4186 - val_accuracy: 0.4981 - val_loss: 1.9338
Epoch 11/1000
567/567 - 48s - 85ms/step - accuracy: 0.8473 - loss: 0.3703 - val_accuracy: 0.5021 - val_loss: 2.0127
Epoch 12/1000
567/567 - 281s - 495ms/step - accuracy: 0.8429 - loss: 0.3735 - val_accuracy: 0.5161 - val_loss: 2.0419
Epoch 13/1000
567/567 - 253s - 446ms/step - accuracy: 0.8801 - loss: 0.2768 - val_accuracy: 0.5114 - val_loss: 2.2451
Epoch 14/1000
567/567 - 92s - 162ms/step - accuracy: 0.8957 - loss: 0.2463 - val_accuracy: 0.5150 - val_loss: 2.5081
Epoch 15/1000
567/567 - 46s - 81ms/step - accuracy: 0.8962 - loss: 0.2688 - val_accuracy: 0.5156 - val_loss: 2.3889
Epoch 16/1000
567/567 - 47s - 82ms/step - accuracy: 0.9136 - loss: 0.2060 - val_accuracy: 0.5177 - val_loss: 2.6016
Epoch 17/1000
567/567 - 46s - 81ms/step - accuracy: 0.9235 - loss: 0.1769 - val_accuracy: 0.5075 - val_loss: 2.7682
Epoch 18/1000
567/567 - 47s - 82ms/step - accuracy: 0.9242 - loss: 0.1893 - val_accuracy: 0.5057 - val_loss: 2.7678
Epoch 19/1000
567/567 - 46s - 81ms/step - accuracy: 0.9384 - loss: 0.1491 - val_accuracy: 0.5158 - val_loss: 2.7909
Epoch 20/1000
567/567 - 49s - 86ms/step - accuracy: 0.9381 - loss: 0.1509 - val_accuracy: 0.5104 - val_loss: 2.9452
Epoch 21/1000
567/567 - 1190s - 2s/step - accuracy: 0.9428 - loss: 0.1393 - val_accuracy: 0.5157 - val_loss: 3.0623
Epoch 22/1000
567/567 - 49s - 87ms/step - accuracy: 0.9554 - loss: 0.1123 - val_accuracy: 0.5027 - val_loss: 3.2508
Epoch 23/1000
567/567 - 47s - 82ms/step - accuracy: 0.9554 - loss: 0.1083 - val_accuracy: 0.5036 - val_loss: 3.3822
Epoch 24/1000
567/567 - 47s - 82ms/step - accuracy: 0.9586 - loss: 0.1084 - val_accuracy: 0.5055 - val_loss: 3.3293
Epoch 25/1000
567/567 - 46s - 81ms/step - accuracy: 0.9664 - loss: 0.0835 - val_accuracy: 0.5161 - val_loss: 3.3808
Epoch 26/1000
567/567 - 47s - 82ms/step - accuracy: 0.9539 - loss: 0.1167 - val_accuracy: 0.5120 - val_loss: 3.2189
Epoch 26: early stopping
Restoring model weights from the end of the best epoch: 16.
Calculating predictions on the test set ..
[Macro]    P: 50.51   R: 50.6   F1: 50.31
[Weighted] P: 51.87   R: 51.77   F1: 51.65

Method: lstm, # genres: 10
Epoch 1/1000
597/597 - 59s - 99ms/step - accuracy: 0.1839 - loss: 2.0281 - val_accuracy: 0.2759 - val_loss: 1.8656
Epoch 2/1000
597/597 - 57s - 95ms/step - accuracy: 0.3759 - loss: 1.5876 - val_accuracy: 0.4365 - val_loss: 1.5650
Epoch 3/1000
597/597 - 49s - 82ms/step - accuracy: 0.4734 - loss: 1.3208 - val_accuracy: 0.4545 - val_loss: 1.5130
Epoch 4/1000
597/597 - 49s - 83ms/step - accuracy: 0.5466 - loss: 1.1354 - val_accuracy: 0.4844 - val_loss: 1.4826
Epoch 5/1000
597/597 - 48s - 81ms/step - accuracy: 0.6220 - loss: 0.9422 - val_accuracy: 0.5048 - val_loss: 1.4302
Epoch 6/1000
597/597 - 636s - 1s/step - accuracy: 0.6739 - loss: 0.8130 - val_accuracy: 0.4937 - val_loss: 1.5484
Epoch 7/1000
597/597 - 79s - 133ms/step - accuracy: 0.7110 - loss: 0.7192 - val_accuracy: 0.4921 - val_loss: 1.6198
Epoch 8/1000
597/597 - 56s - 95ms/step - accuracy: 0.7575 - loss: 0.5940 - val_accuracy: 0.4999 - val_loss: 1.7308
Epoch 9/1000
597/597 - 47s - 79ms/step - accuracy: 0.7929 - loss: 0.5032 - val_accuracy: 0.5175 - val_loss: 1.7773
Epoch 10/1000
597/597 - 46s - 78ms/step - accuracy: 0.8166 - loss: 0.4465 - val_accuracy: 0.5015 - val_loss: 1.8631
Epoch 11/1000
597/597 - 46s - 78ms/step - accuracy: 0.8263 - loss: 0.4249 - val_accuracy: 0.5139 - val_loss: 1.9954
Epoch 12/1000
597/597 - 43s - 72ms/step - accuracy: 0.8504 - loss: 0.3615 - val_accuracy: 0.5082 - val_loss: 2.1253
Epoch 13/1000
597/597 - 33s - 56ms/step - accuracy: 0.8750 - loss: 0.3010 - val_accuracy: 0.5183 - val_loss: 2.2151
Epoch 14/1000
597/597 - 33s - 56ms/step - accuracy: 0.8871 - loss: 0.2739 - val_accuracy: 0.5100 - val_loss: 2.2591
Epoch 15/1000
597/597 - 34s - 56ms/step - accuracy: 0.9011 - loss: 0.2460 - val_accuracy: 0.5018 - val_loss: 2.4319
Epoch 16/1000
597/597 - 33s - 55ms/step - accuracy: 0.9096 - loss: 0.2246 - val_accuracy: 0.5106 - val_loss: 2.5095
Epoch 17/1000
597/597 - 33s - 55ms/step - accuracy: 0.9175 - loss: 0.2034 - val_accuracy: 0.5087 - val_loss: 2.7390
Epoch 18/1000
597/597 - 35s - 59ms/step - accuracy: 0.9241 - loss: 0.1859 - val_accuracy: 0.4937 - val_loss: 2.7401
Epoch 19/1000
597/597 - 767s - 1s/step - accuracy: 0.9275 - loss: 0.1839 - val_accuracy: 0.5012 - val_loss: 2.7507
Epoch 20/1000
597/597 - 30s - 50ms/step - accuracy: 0.9382 - loss: 0.1697 - val_accuracy: 0.5078 - val_loss: 2.8518
Epoch 21/1000
597/597 - 31s - 52ms/step - accuracy: 0.9474 - loss: 0.1329 - val_accuracy: 0.5068 - val_loss: 3.0649
Epoch 22/1000
597/597 - 31s - 53ms/step - accuracy: 0.9471 - loss: 0.1289 - val_accuracy: 0.5091 - val_loss: 3.1091
Epoch 23/1000
597/597 - 31s - 52ms/step - accuracy: 0.9527 - loss: 0.1228 - val_accuracy: 0.4976 - val_loss: 3.3472
Epoch 23: early stopping
Restoring model weights from the end of the best epoch: 13.
Calculating predictions on the test set ..
[Macro]    P: 49.64   R: 52.14   F1: 50.5
[Weighted] P: 52.3   R: 51.83   F1: 51.78

Method: lstm, # genres: 11
Epoch 1/1000
620/620 - 33s - 53ms/step - accuracy: 0.2059 - loss: 2.1048 - val_accuracy: 0.3178 - val_loss: 1.9075
Epoch 2/1000
620/620 - 32s - 51ms/step - accuracy: 0.3369 - loss: 1.7141 - val_accuracy: 0.3992 - val_loss: 1.6994
Epoch 3/1000
620/620 - 32s - 52ms/step - accuracy: 0.4305 - loss: 1.4271 - val_accuracy: 0.4079 - val_loss: 1.6950
Epoch 4/1000
620/620 - 1209s - 2s/step - accuracy: 0.5078 - loss: 1.2215 - val_accuracy: 0.4254 - val_loss: 1.6379
Epoch 5/1000
620/620 - 34s - 55ms/step - accuracy: 0.5788 - loss: 1.0292 - val_accuracy: 0.4428 - val_loss: 1.6975
Epoch 6/1000
620/620 - 35s - 57ms/step - accuracy: 0.6286 - loss: 0.8957 - val_accuracy: 0.4468 - val_loss: 1.6918
Epoch 7/1000
620/620 - 35s - 57ms/step - accuracy: 0.6797 - loss: 0.7664 - val_accuracy: 0.4677 - val_loss: 1.7611
Epoch 8/1000
620/620 - 36s - 58ms/step - accuracy: 0.7179 - loss: 0.6631 - val_accuracy: 0.4549 - val_loss: 1.8954
Epoch 9/1000
620/620 - 36s - 58ms/step - accuracy: 0.7514 - loss: 0.5828 - val_accuracy: 0.4487 - val_loss: 1.9299
Epoch 10/1000
620/620 - 37s - 59ms/step - accuracy: 0.7792 - loss: 0.5097 - val_accuracy: 0.4705 - val_loss: 2.0977
Epoch 11/1000
620/620 - 37s - 59ms/step - accuracy: 0.8082 - loss: 0.4409 - val_accuracy: 0.4758 - val_loss: 2.1642
Epoch 12/1000
620/620 - 37s - 60ms/step - accuracy: 0.8259 - loss: 0.4000 - val_accuracy: 0.4682 - val_loss: 2.2069
Epoch 13/1000
620/620 - 2290s - 4s/step - accuracy: 0.8362 - loss: 0.3729 - val_accuracy: 0.4732 - val_loss: 2.3961
Epoch 14/1000
620/620 - 29s - 47ms/step - accuracy: 0.8633 - loss: 0.3162 - val_accuracy: 0.4862 - val_loss: 2.4176
Epoch 15/1000
620/620 - 31s - 49ms/step - accuracy: 0.8804 - loss: 0.2721 - val_accuracy: 0.4754 - val_loss: 2.6994
Epoch 16/1000
620/620 - 31s - 50ms/step - accuracy: 0.8799 - loss: 0.2795 - val_accuracy: 0.4735 - val_loss: 2.6486
Epoch 17/1000
620/620 - 31s - 50ms/step - accuracy: 0.8929 - loss: 0.2530 - val_accuracy: 0.4870 - val_loss: 2.7886
Epoch 18/1000
620/620 - 31s - 50ms/step - accuracy: 0.9076 - loss: 0.2049 - val_accuracy: 0.4857 - val_loss: 2.9228
Epoch 19/1000
620/620 - 31s - 50ms/step - accuracy: 0.9202 - loss: 0.1843 - val_accuracy: 0.4584 - val_loss: 3.0301
Epoch 20/1000
620/620 - 32s - 51ms/step - accuracy: 0.9237 - loss: 0.1728 - val_accuracy: 0.4776 - val_loss: 3.2245
Epoch 21/1000
620/620 - 32s - 51ms/step - accuracy: 0.9289 - loss: 0.1633 - val_accuracy: 0.4645 - val_loss: 3.1937
Epoch 22/1000
620/620 - 32s - 52ms/step - accuracy: 0.9231 - loss: 0.1756 - val_accuracy: 0.4575 - val_loss: 3.2012
Epoch 23/1000
620/620 - 33s - 53ms/step - accuracy: 0.9249 - loss: 0.1740 - val_accuracy: 0.4534 - val_loss: 3.1578
Epoch 24/1000
620/620 - 70s - 113ms/step - accuracy: 0.9347 - loss: 0.1531 - val_accuracy: 0.4650 - val_loss: 3.3826
Epoch 25/1000
620/620 - 31s - 50ms/step - accuracy: 0.9512 - loss: 0.1159 - val_accuracy: 0.4845 - val_loss: 3.6520
Epoch 26/1000
620/620 - 32s - 51ms/step - accuracy: 0.9524 - loss: 0.1098 - val_accuracy: 0.4436 - val_loss: 3.8800
Epoch 27/1000
620/620 - 32s - 52ms/step - accuracy: 0.9504 - loss: 0.1162 - val_accuracy: 0.4642 - val_loss: 3.6395
Epoch 27: early stopping
Restoring model weights from the end of the best epoch: 17.
Calculating predictions on the test set ..
[Macro]    P: 45.6   R: 46.91   F1: 46.03
[Weighted] P: 48.85   R: 48.7   F1: 48.59

Method: lstm, # genres: 12
Epoch 1/1000
651/651 - 36s - 55ms/step - accuracy: 0.1705 - loss: 2.2139 - val_accuracy: 0.2871 - val_loss: 1.9957
Epoch 2/1000
651/651 - 35s - 54ms/step - accuracy: 0.3460 - loss: 1.7404 - val_accuracy: 0.3811 - val_loss: 1.7618
Epoch 3/1000
651/651 - 36s - 55ms/step - accuracy: 0.4459 - loss: 1.4171 - val_accuracy: 0.3934 - val_loss: 1.6911
Epoch 4/1000
651/651 - 126s - 193ms/step - accuracy: 0.5102 - loss: 1.2261 - val_accuracy: 0.4115 - val_loss: 1.6777
Epoch 5/1000
651/651 - 52s - 80ms/step - accuracy: 0.5718 - loss: 1.0464 - val_accuracy: 0.4260 - val_loss: 1.6867
Epoch 6/1000
651/651 - 52s - 80ms/step - accuracy: 0.6238 - loss: 0.9040 - val_accuracy: 0.4300 - val_loss: 1.7857
Epoch 7/1000
651/651 - 53s - 82ms/step - accuracy: 0.6692 - loss: 0.7871 - val_accuracy: 0.4654 - val_loss: 1.8209
Epoch 8/1000
651/651 - 53s - 82ms/step - accuracy: 0.7068 - loss: 0.6829 - val_accuracy: 0.4532 - val_loss: 1.8832
Epoch 9/1000
651/651 - 53s - 82ms/step - accuracy: 0.7472 - loss: 0.5836 - val_accuracy: 0.4738 - val_loss: 1.9759
Epoch 10/1000
651/651 - 93s - 142ms/step - accuracy: 0.7847 - loss: 0.4945 - val_accuracy: 0.4636 - val_loss: 2.1680
Epoch 11/1000
651/651 - 66s - 101ms/step - accuracy: 0.8044 - loss: 0.4613 - val_accuracy: 0.4667 - val_loss: 2.2397
Epoch 12/1000
651/651 - 56s - 87ms/step - accuracy: 0.8256 - loss: 0.3985 - val_accuracy: 0.4656 - val_loss: 2.4200
Epoch 13/1000
651/651 - 54s - 83ms/step - accuracy: 0.8496 - loss: 0.3321 - val_accuracy: 0.4521 - val_loss: 2.4621
Epoch 14/1000
651/651 - 53s - 82ms/step - accuracy: 0.8677 - loss: 0.2992 - val_accuracy: 0.4638 - val_loss: 2.6437
Epoch 15/1000
651/651 - 54s - 83ms/step - accuracy: 0.8808 - loss: 0.2750 - val_accuracy: 0.4700 - val_loss: 2.7391
Epoch 16/1000
651/651 - 53s - 82ms/step - accuracy: 0.8899 - loss: 0.2477 - val_accuracy: 0.4609 - val_loss: 2.9244
Epoch 17/1000
651/651 - 55s - 84ms/step - accuracy: 0.8916 - loss: 0.2469 - val_accuracy: 0.4648 - val_loss: 3.0275
Epoch 18/1000
651/651 - 54s - 83ms/step - accuracy: 0.9062 - loss: 0.2177 - val_accuracy: 0.4636 - val_loss: 2.9271
Epoch 19/1000
651/651 - 54s - 83ms/step - accuracy: 0.9149 - loss: 0.1855 - val_accuracy: 0.4722 - val_loss: 3.2257
Epoch 19: early stopping
Restoring model weights from the end of the best epoch: 9.
Calculating predictions on the test set ..
[Macro]    P: 45.99   R: 47.62   F1: 45.91
[Weighted] P: 48.72   R: 47.38   F1: 47.34
